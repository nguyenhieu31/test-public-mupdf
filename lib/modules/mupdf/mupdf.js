"use strict";import e from"./mupdf-wasm.js";var t=null;"undefined"!=typeof process&&process.versions&&process.versions.node&&(t=await import("node:fs"));const n=await e(globalThis.$libmupdf_wasm_Module);function _(e){return n._wasm_malloc(e)}function r(e){n._wasm_free(e)}n._wasm_init_context();export const memento={listBlocks(){n._wasm_Memento_listBlocks()},checkAllMemory(){n._wasm_Memento_checkAllMemory()}};export const Matrix={identity:[1,0,0,1,0,0],scale:(e,t)=>[e,0,0,t,0,0],translate:(e,t)=>[1,0,0,1,e,t],rotate(e){for(;e<0;)e+=360;for(;e>=360;)e-=360;let t=Math.sin(e*Math.PI/180),n=Math.cos(e*Math.PI/180);return[n,t,-t,n,0,0]},invert(e){f(e);let t=e[0]*e[3]-e[1]*e[2];if(t>-1e-23&&t<1e-23)return e;let n=1/t,_=e[3]*n,r=-e[1]*n,i=-e[2]*n,s=e[0]*n;return[_,r,i,s,-e[4]*_-e[5]*i,-e[4]*r-e[5]*s]},concat:(e,t)=>(f(e),f(t),[e[0]*t[0]+e[1]*t[2],e[0]*t[1]+e[1]*t[3],e[2]*t[0]+e[3]*t[2],e[2]*t[1]+e[3]*t[3],e[4]*t[0]+e[5]*t[2]+t[4],e[4]*t[1]+e[5]*t[3]+t[5]])};export const Rect={MIN_INF_RECT:2147483648,MAX_INF_RECT:2147483520,empty:[2147483648,2147483648,2147483520,2147483520],invalid:[0,0,-1,-1],infinite:[2147483520,2147483520,2147483648,2147483648],isEmpty:function(e){return h(e),e[0]>=e[2]||e[1]>=e[3]},isValid:function(e){return h(e),e[0]<=e[2]&&e[1]<=e[3]},isInfinite:function(e){return h(e),e[0]===Rect.MAX_INF_RECT&&e[1]===Rect.MAX_INF_RECT&&e[2]===Rect.MIN_INF_RECT&&e[3]===Rect.MIN_INF_RECT},transform:function(e,t){var n;if(h(e),f(t),Rect.isInfinite(e))return e;if(!Rect.isValid(e))return e;var _=e[0]*t[0],r=e[2]*t[0];_>r&&(n=_,_=r,r=n);var i=e[1]*t[2],s=e[3]*t[2];i>s&&(n=i,i=s,s=n),_+=i+t[4],r+=s+t[4];var o=e[0]*t[1],a=e[2]*t[1];o>a&&(n=o,o=a,a=n);var p=e[1]*t[3],m=e[3]*t[3];return p>m&&(n=p,p=m,m=n),[_,o+=p+t[5],r,a+=m+t[5]]}};export function enableICC(){n._wasm_enable_icc()}export function disableICC(){n._wasm_disable_icc()}export function setUserCSS(e){n._wasm_set_user_css(F(e))}export function installLoadFontFunction(e){J=e}const i=_(4),s=_(24)>>2,o=_(32)>>2,a=_(24)>>2,p=_(16)>>2,m=_(32)>>2,l=[0,0];function d(e,t){if("string"==typeof t&&typeof e!==t)throw new TypeError("expected "+t);if("function"==typeof t&&!(e instanceof t))throw new TypeError("expected "+t.name)}function u(e){if(!Array.isArray(e)||2!==e.length)throw new TypeError("expected point")}function h(e){if(!Array.isArray(e)||4!==e.length)throw new TypeError("expected rectangle")}function f(e){if(!Array.isArray(e)||6!==e.length)throw new TypeError("expected matrix")}function w(e){if(!Array.isArray(e)||8!==e.length)throw new TypeError("expected quad")}function c(e){if(!Array.isArray(e)||1!==e.length&&3!==e.length&&4!==e.length)throw new TypeError("expected color array")}function g(e){if(!Array.isArray(e)||0!==e.length&&1!==e.length&&3!==e.length&&4!==e.length)throw new TypeError("expected color array")}function D(e){if(e instanceof Buffer)return e.pointer;if(e instanceof ArrayBuffer||e instanceof Uint8Array)return new Buffer(e).pointer;if("string"==typeof e)return new Buffer(e).pointer;throw new TypeError("expected buffer")}function P(e,t){if("number"==typeof e&&e>=0&&e<t.length)return e;if("string"==typeof e){let n=t.indexOf(e);if(n>=0)return n}throw new TypeError(`invalid enum value ("${e}"; expected ${t.join(", ")})`)}function b(e,t){return l[t]&&(r(l[t]),l[t]=0),l[t]=(i=e,s=n.lengthBytesUTF8(i)+1,o=_(s),n.stringToUTF8(i,o,s),o);var i,s,o}function F(e){return b(e,0)}function E(e){return b(e,1)}function y(e){return"string"==typeof e?b(e,0):0}function x(e){return"string"==typeof e?b(e,1):0}function S(e){return n.HEAPF32[s+0]=e[0],n.HEAPF32[s+1]=e[1],s<<2}function A(e){return n.HEAPF32[s+2]=e[0],n.HEAPF32[s+3]=e[1],s+2<<2}function T(e){return n.HEAPF32[o+0]=e[0],n.HEAPF32[o+1]=e[1],n.HEAPF32[o+2]=e[2],n.HEAPF32[o+3]=e[3],o<<2}function I(e){return n.HEAPF32[a+0]=e[0],n.HEAPF32[a+1]=e[1],n.HEAPF32[a+2]=e[2],n.HEAPF32[a+3]=e[3],n.HEAPF32[a+4]=e[4],n.HEAPF32[a+5]=e[5],a<<2}function O(e){return n.HEAPF32[m+0]=e[0],n.HEAPF32[m+1]=e[1],n.HEAPF32[m+2]=e[2],n.HEAPF32[m+3]=e[3],n.HEAPF32[m+4]=e[4],n.HEAPF32[m+5]=e[5],n.HEAPF32[m+6]=e[6],n.HEAPF32[m+7]=e[7],m<<2}function k(e){if(void 0!==e)switch(e.length){case 0:break;case 1:n.HEAPF32[p+0]=e[0];break;case 3:n.HEAPF32[p+0]=e[0],n.HEAPF32[p+1]=e[1],n.HEAPF32[p+2]=e[2];break;case 4:n.HEAPF32[p+0]=e[0],n.HEAPF32[p+1]=e[1],n.HEAPF32[p+2]=e[2],n.HEAPF32[p+3]=e[3]}return p<<2}function L(e){return 0===e?[]:function(e){if(1===e)return[n.HEAPF32[p]];if(3===e)return[n.HEAPF32[p+0],n.HEAPF32[p+1],n.HEAPF32[p+2]];if(4===e)return[n.HEAPF32[p+0],n.HEAPF32[p+1],n.HEAPF32[p+2],n.HEAPF32[p+3]];throw new TypeError("invalid number of components for Color: "+e)}(e)}function C(e,t){let _=t>>2,r=[];for(let t=0;t<e;++t)r.push(n.HEAPF32[_+t]);return r}function N(e){return 0===e?null:n.UTF8ToString(e)}function v(e){return n.UTF8ToString(e)}function B(e){let t=n.UTF8ToString(e);return r(e),t}function R(e){let t=e>>2;return[n.HEAPF32[t+0],n.HEAPF32[t+1]]}function j(e){let t=e>>2;return[n.HEAPF32[t+0],n.HEAPF32[t+1],n.HEAPF32[t+2],n.HEAPF32[t+3]]}function H(e){let t=e>>2;return[n.HEAPF32[t+0],n.HEAPF32[t+1],n.HEAPF32[t+2],n.HEAPF32[t+3],n.HEAPF32[t+4],n.HEAPF32[t+5]]}function M(e){let t=e>>2;return[n.HEAPF32[t+0],n.HEAPF32[t+1],n.HEAPF32[t+2],n.HEAPF32[t+3],n.HEAPF32[t+4],n.HEAPF32[t+5],n.HEAPF32[t+6],n.HEAPF32[t+7]]}function G(e){let t=n._wasm_buffer_get_data(e),_=n._wasm_buffer_get_len(e);return n.HEAPU8.slice(t,t+_)}function U(e,t,i,s=500){d(i,"string");let o=0,a=0;try{o=_(32*s),a=_(4*s);let r=e(t,F(i),a,o,s),p=[];if(r>0){let e=[];for(let t=0;t<r;++t){let _=n.HEAP32[(a>>2)+t],r=M(o+32*t);t>0&&_&&(p.push(e),e=[]),e.push(r)}p.push(e)}return p}finally{r(a),r(o)}}class W{constructor(e){if("number"!=typeof e)throw new Error("invalid pointer: "+typeof e);if(0!==e){let t=this.constructor;t._finalizer||(t._finalizer=new FinalizationRegistry(t._drop)),t._finalizer.register(this,e,this)}this.pointer=e}destroy(){if(0!==this.pointer){let e=this.constructor;e._finalizer.unregister(this),e._drop(this.pointer)}this.pointer=0}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}toString(){return`[${this.constructor.name} ${this.pointer}]`}valueOf(){throw new Error("cannot convert Userdata to Javascript value")}}export class Buffer extends W{constructor(e){if(void 0===e)super(n._wasm_new_buffer(1024));else if("number"==typeof e)super(e);else if("string"==typeof e){let t=n.lengthBytesUTF8(e),r=_(t+1);n.stringToUTF8(e,r,t+1),super(n._wasm_new_buffer_from_data(r,t))}else if(e instanceof ArrayBuffer||e instanceof Uint8Array){let t=e.byteLength,r=_(t);n.HEAPU8.set(new Uint8Array(e),r),super(n._wasm_new_buffer_from_data(r,t))}}get length(){return this.getLength()}set length(e){throw new TypeError("buffer length is read-only")}getLength(){return n._wasm_buffer_get_len(this.pointer)}readByte(e){let t=n._wasm_buffer_get_data(this.pointer);return n.HEAPU8[t+e]}write(e){n._wasm_append_string(this.pointer,F(e))}writeByte(e){n._wasm_append_byte(this.pointer,e)}writeLine(e){this.write(e),this.writeByte(10)}writeBuffer(e){n._wasm_append_buffer(this.pointer,D(e))}asUint8Array(){let e=n._wasm_buffer_get_data(this.pointer),t=n._wasm_buffer_get_len(this.pointer);return n.HEAPU8.subarray(e,e+t)}slice(e,t){return void 0===t&&(t=this.getLength()),new Buffer(n._wasm_slice_buffer(this.pointer,e,t))}asString(){return v(n._wasm_string_from_buffer(this.pointer))}save(e){if(!t)throw new Error("missing 'fs' module");t.writeFileSync(e,this.asUint8Array())}}Buffer._drop=n._wasm_drop_buffer;export class ColorSpace extends W{constructor(e,_){if("number"==typeof e)super(e);else{if("string"==typeof e){if(!t)throw new Error("missing 'fs' module");e=t.readFileSync(e)}super(n._wasm_new_icc_colorspace(y(_),D(e)))}}getName(){return v(n._wasm_colorspace_get_name(this.pointer))}getType(){return ColorSpace.COLORSPACE_TYPES[n._wasm_colorspace_get_type(this.pointer)]||"None"}getNumberOfComponents(){return n._wasm_colorspace_get_n(this.pointer)}isGray(){return"Gray"===this.getType()}isRGB(){return"RGB"===this.getType()}isCMYK(){return"CMYK"===this.getType()}isIndexed(){return"Indexed"===this.getType()}isLab(){return"Lab"===this.getType()}isDeviceN(){return"Separation"===this.getType()}isSubtractive(){return"CMYK"===this.getType()||"Separation"===this.getType()}toString(){return"[ColorSpace "+this.getName()+"]"}}ColorSpace._drop=n._wasm_drop_colorspace,ColorSpace.COLORSPACE_TYPES=["None","Gray","RGB","BGR","CMYK","Lab","Indexed","Separation"],ColorSpace.DeviceGray=new ColorSpace(n._wasm_device_gray()),ColorSpace.DeviceRGB=new ColorSpace(n._wasm_device_rgb()),ColorSpace.DeviceBGR=new ColorSpace(n._wasm_device_bgr()),ColorSpace.DeviceCMYK=new ColorSpace(n._wasm_device_cmyk()),ColorSpace.Lab=new ColorSpace(n._wasm_device_lab());export class Font extends W{constructor(e,_,r=0){let i=0;if("number"==typeof e)i=n._wasm_keep_font(e);else{if("string"==typeof _){if(!t)throw new Error("missing 'fs' module");_=t.readFileSync(_)}i=_?n._wasm_new_font_from_buffer(F(e),D(_),r):"zh-Hant"===e?n._wasm_new_cjk_font(Font.ADOBE_CNS):"zh-Hans"===e?n._wasm_new_cjk_font(Font.ADOBE_GB):"ja"===e?n._wasm_new_cjk_font(Font.ADOBE_JAPAN):"ko"===e?n._wasm_new_cjk_font(Font.ADOBE_KOREA):n._wasm_new_base14_font(F(e))}super(i)}getName(){return v(n._wasm_font_get_name(this.pointer))}encodeCharacter(e){return"string"==typeof e&&(e=e.charCodeAt(0)),n._wasm_encode_character(this.pointer,e)}advanceGlyph(e,t=0){return n._wasm_advance_glyph(this.pointer,e,t)}isMono(){return!!n._wasm_font_is_monospaced(this.pointer)}isSerif(){return!!n._wasm_font_is_serif(this.pointer)}isBold(){return!!n._wasm_font_is_bold(this.pointer)}isItalic(){return!!n._wasm_font_is_italic(this.pointer)}}Font._drop=n._wasm_drop_font,Font.SIMPLE_ENCODING=["Latin","Greek","Cyrillic"],Font.ADOBE_CNS=0,Font.ADOBE_GB=1,Font.ADOBE_JAPAN=2,Font.ADOBE_KOREA=3,Font.CJK_ORDERING_BY_LANG={"Adobe-CNS1":0,"Adobe-GB1":1,"Adobe-Japan1":2,"Adobe-Korea1":3,"zh-Hant":0,"zh-TW":0,"zh-HK":0,"zh-Hans":1,"zh-CN":1,ja:2,ko:3};export class Image extends W{constructor(e,_){let r=0;if("number"==typeof e)r=n._wasm_keep_image(e);else if(e instanceof Pixmap)r=n._wasm_new_image_from_pixmap(e.pointer,_?_.pointer:0);else{if("string"==typeof e){if(!t)throw new Error("missing 'fs' module");e=t.readFileSync(e)}r=n._wasm_new_image_from_buffer(D(e))}super(r)}getWidth(){return n._wasm_image_get_w(this.pointer)}getHeight(){return n._wasm_image_get_h(this.pointer)}getNumberOfComponents(){return n._wasm_image_get_n(this.pointer)}getBitsPerComponent(){return n._wasm_image_get_bpc(this.pointer)}getXResolution(){return n._wasm_image_get_xres(this.pointer)}getYResolution(){return n._wasm_image_get_yres(this.pointer)}getImageMask(){return!!n._wasm_image_get_imagemask(this.pointer)}getColorSpace(){let e=n._wasm_image_get_colorspace(this.pointer);return e?new ColorSpace(n._wasm_keep_colorspace(e)):null}getMask(){let e=n._wasm_image_get_mask(this.pointer);return e?new Image(n._wasm_keep_image(e)):null}toPixmap(){return new Pixmap(n._wasm_get_pixmap_from_image(this.pointer))}}Image._drop=n._wasm_drop_image;export class StrokeState extends W{constructor(e){if("number"==typeof e)return super(e),this;super(n._wasm_new_stroke_state(e?.dashes?.length??0));let t=P(e.lineCap,StrokeState.LINE_CAP),_=P(e.lineJoin,StrokeState.LINE_JOIN);if(n._wasm_stroke_state_set_start_cap(this.pointer,t),n._wasm_stroke_state_set_dash_cap(this.pointer,t),n._wasm_stroke_state_set_end_cap(this.pointer,t),n._wasm_stroke_state_set_linejoin(this.pointer,_),n._wasm_stroke_state_set_linewidth(this.pointer,e.lineWidth),n._wasm_stroke_state_set_miterlimit(this.pointer,e.miterLimit),n._wasm_stroke_state_set_dash_phase(this.pointer,e.dashPhase??0),e.dashes)for(let t=0;t<e.dashes.length;++t)n._wasm_stroke_state_set_dash_item(this.pointer,t,e.dashes[t]??0)}getLineCap(){return n._wasm_stroke_state_get_start_cap(this.pointer)}getLineJoin(){return n._wasm_stroke_state_get_linejoin(this.pointer)}getLineWidth(){return n._wasm_stroke_state_get_linewidth(this.pointer)}getMiterLimit(){return n._wasm_stroke_state_get_miterlimit(this.pointer)}getDashPhase(){return n._wasm_stroke_state_get_dash_phase(this.pointer)}getDashes(){var e=n._wasm_stroke_state_get_dash_len(this.pointer);if(e>0){var t=[];for(let _=0;_<e;++_)t[_]=n._wasm_stroke_state_get_dash_item(this.pointer,_);return t}return null}}StrokeState._drop=n._wasm_drop_stroke_state,StrokeState.LINE_CAP=["Butt","Round","Square","Triangle"],StrokeState.LINE_JOIN=["Miter","Round","Bevel","MiterXPS"];export class Path extends W{constructor(e){super("number"==typeof e?e:n._wasm_new_path())}getBounds(e,t){return null!==e&&d(e,StrokeState),f(t),j(n._wasm_bound_path(this.pointer,e?.pointer,I(t)))}moveTo(e,t){d(e,"number"),d(t,"number"),n._wasm_moveto(this.pointer,e,t)}lineTo(e,t){d(e,"number"),d(t,"number"),n._wasm_lineto(this.pointer,e,t)}curveTo(e,t,_,r,i,s){d(e,"number"),d(t,"number"),d(_,"number"),d(r,"number"),d(i,"number"),d(s,"number"),n._wasm_curveto(this.pointer,e,t,_,r,i,s)}curveToV(e,t,_,r){d(e,"number"),d(t,"number"),d(_,"number"),d(r,"number"),n._wasm_curvetov(this.pointer,e,t,_,r)}curveToY(e,t,_,r){d(e,"number"),d(t,"number"),d(_,"number"),d(r,"number"),n._wasm_curvetoy(this.pointer,e,t,_,r)}closePath(){n._wasm_closepath(this.pointer)}rect(e,t,_,r){d(e,"number"),d(t,"number"),d(_,"number"),d(r,"number"),n._wasm_rectto(this.pointer,e,t,_,r)}transform(e){f(e),n._wasm_transform_path(this.pointer,I(e))}walk(e){let t=X++;q.set(t,e),n._wasm_walk_path(this.pointer,t),q.delete(t)}}Path._drop=n._wasm_drop_path;export class Text extends W{constructor(e){super("number"==typeof e?e:n._wasm_new_text())}getBounds(e,t){return null!==e&&d(e,StrokeState),f(t),j(n._wasm_bound_text(this.pointer,e?.pointer,I(t)))}showGlyph(e,t,_,r,i=0){d(e,Font),f(t),d(_,"number"),d(r,"number"),n._wasm_show_glyph(this.pointer,e.pointer,I(t),_,r,i)}showString(e,t,_,r=0){return d(e,Font),f(t),d(_,"string"),H(n._wasm_show_string(this.pointer,e.pointer,I(t),F(_),r))}walk(e){let t=$++;Q.set(t,e),n._wasm_walk_text(this.pointer,t),Q.delete(t)}}Text._drop=n._wasm_drop_text;export class DisplayList extends W{constructor(e){let t=0;"number"==typeof e?t=e:(h(e),t=n._wasm_new_display_list(T(e))),super(t)}getBounds(){return j(n._wasm_bound_display_list(this.pointer))}toPixmap(e,t,_=!1){return f(e),d(t,ColorSpace),new Pixmap(n._wasm_new_pixmap_from_display_list(this.pointer,I(e),t.pointer,_))}toStructuredText(e=""){return d(e,"string"),new StructuredText(n._wasm_new_stext_page_from_display_list(this.pointer,F(e)))}run(e,t){d(e,Device),f(t),n._wasm_run_display_list(this.pointer,e.pointer,I(t))}search(e,t=500){return U(n._wasm_search_display_list,this.pointer,e,t)}}DisplayList._drop=n._wasm_drop_display_list;export class Pixmap extends W{constructor(e,t,_=!1){"number"==typeof e&&super(e),e instanceof ColorSpace&&(h(t),super(n._wasm_new_pixmap_with_bbox(e.pointer,T(t),_))),null===e&&(h(t),super(n._wasm_new_pixmap_with_bbox(0,T(t),_)))}getBounds(){let e=n._wasm_pixmap_get_x(this.pointer),t=n._wasm_pixmap_get_y(this.pointer);return[e,t,e+n._wasm_pixmap_get_w(this.pointer),t+n._wasm_pixmap_get_h(this.pointer)]}clear(e){void 0===e?n._wasm_clear_pixmap(this.pointer):n._wasm_clear_pixmap_with_value(this.pointer,e)}getWidth(){return n._wasm_pixmap_get_w(this.pointer)}getHeight(){return n._wasm_pixmap_get_h(this.pointer)}getX(){return n._wasm_pixmap_get_x(this.pointer)}getY(){return n._wasm_pixmap_get_y(this.pointer)}getStride(){return n._wasm_pixmap_get_stride(this.pointer)}getNumberOfComponents(){return n._wasm_pixmap_get_n(this.pointer)}getAlpha(){return n._wasm_pixmap_get_alpha(this.pointer)}getXResolution(){return n._wasm_pixmap_get_xres(this.pointer)}getYResolution(){return n._wasm_pixmap_get_yres(this.pointer)}setResolution(e,t){n._wasm_pixmap_set_xres(this.pointer,e),n._wasm_pixmap_set_yres(this.pointer,t)}getColorSpace(){let e=n._wasm_pixmap_get_colorspace(this.pointer);return e?new ColorSpace(n._wasm_keep_colorspace(e)):null}getPixels(){let e=n._wasm_pixmap_get_stride(this.pointer),t=n._wasm_pixmap_get_h(this.pointer),_=n._wasm_pixmap_get_samples(this.pointer);return new Uint8ClampedArray(n.HEAPU8.buffer,_,e*t)}asPNG(){let e=n._wasm_new_buffer_from_pixmap_as_png(this.pointer);try{return G(e)}finally{n._wasm_drop_buffer(e)}}asPSD(){let e=n._wasm_new_buffer_from_pixmap_as_psd(this.pointer);try{return G(e)}finally{n._wasm_drop_buffer(e)}}asPAM(){let e=n._wasm_new_buffer_from_pixmap_as_pam(this.pointer);try{return G(e)}finally{n._wasm_drop_buffer(e)}}asJPEG(e,t=!1){let _=n._wasm_new_buffer_from_pixmap_as_jpeg(this.pointer,e,t);try{return G(_)}finally{n._wasm_drop_buffer(_)}}invert(){n._wasm_invert_pixmap(this.pointer)}invertLuminance(){n._wasm_invert_pixmap_luminance(this.pointer)}gamma(e){n._wasm_gamma_pixmap(this.pointer,e)}tint(e,t){let _=0,r=16777215;"number"==typeof e?_=e:e instanceof Array&&3===e.length&&(_=255*e[0]<<16|255*e[1]<<8|255*e[2]),"number"==typeof t?r=t:t instanceof Array&&3===t.length&&(t=255*t[0]<<16|255*t[1]<<8|255*t[2]),n._wasm_tint_pixmap(this.pointer,_,r)}convertToColorSpace(e,t=!1){return d(e,ColorSpace),d(t,"boolean"),new Pixmap(n._wasm_convert_pixmap(this.pointer,e.pointer,t))}warp(e,t,_){let r=e.flat();return w(r),d(t,"number"),d(_,"number"),new Pixmap(n._wasm_warp_pixmap(this.pointer,O(r),t,_))}}Pixmap._drop=n._wasm_drop_pixmap;export class Shade extends W{getBounds(){return j(n._wasm_bound_shade(this.pointer))}}Shade._drop=n._wasm_drop_shade;export class StructuredText extends W{walk(e){let t=n._wasm_stext_page_get_first_block(this.pointer);for(;t;){let r=n._wasm_stext_block_get_type(t),i=j(n._wasm_stext_block_get_bbox(t));if(1===r){if(e.onImageBlock){let _=H(n._wasm_stext_block_get_transform(t)),r=new Image(n._wasm_stext_block_get_image(t));e.onImageBlock(i,_,r)}}else{e.beginTextBlock&&e.beginTextBlock(i);let r=n._wasm_stext_block_get_first_line(t);for(;r;){let t=j(n._wasm_stext_line_get_bbox(r)),i=n._wasm_stext_line_get_wmode(r),s=R(n._wasm_stext_line_get_dir(r));if(e.beginLine&&e.beginLine(t,i,s),e.onChar){let t=n._wasm_stext_line_get_first_char(r);for(;t;){let r=String.fromCharCode(n._wasm_stext_char_get_c(t)),i=R(n._wasm_stext_char_get_origin(t)),s=new Font(n._wasm_stext_char_get_font(t)),o=n._wasm_stext_char_get_size(t),a=M(n._wasm_stext_char_get_quad(t)),p=[((_=n._wasm_stext_char_get_argb(t))>>16&255)/255,(_>>8&255)/255,(255&_)/255];e.onChar(r,i,s,o,a,p),t=n._wasm_stext_char_get_next(t)}}e.endLine&&e.endLine(),r=n._wasm_stext_line_get_next(r)}e.endTextBlock&&e.endTextBlock()}t=n._wasm_stext_block_get_next(t)}var _}asJSON(e=1){return B(n._wasm_print_stext_page_as_json(this.pointer,e))}asHTML(e){return B(n._wasm_print_stext_page_as_html(this.pointer,e))}asText(){return B(n._wasm_print_stext_page_as_text(this.pointer))}snap(e,t,_){let r=P(_,StructuredText.SELECT_MODE);return M(n._wasm_snap_selection(this.pointer,S(e),A(t),r))}copy(e,t){return B(n._wasm_copy_selection(this.pointer,S(e),A(t)))}highlight(e,t,i=100){let s=0,o=[];try{s=_(32*i);let r=n._wasm_highlight_selection(this.pointer,S(e),A(t),s,i);for(let e=0;e<r;++e)o.push(M(s+32*e))}finally{r(s)}return o}search(e,t=500){return U(n._wasm_search_stext_page,this.pointer,e,t)}}StructuredText._drop=n._wasm_drop_stext_page,StructuredText.SELECT_MODE=["chars","words","lines"],StructuredText.SELECT_CHARS="chars",StructuredText.SELECT_WORDS="words",StructuredText.SELECT_LINES="lines";export class Device extends W{constructor(e){if("number"==typeof e)super(e);else{let t=Y++;z.set(t,e),super(n._wasm_new_js_device(t))}}fillPath(e,t,_,r,i,s){d(e,Path),f(_),d(r,ColorSpace),c(i),n._wasm_fill_path(this.pointer,e.pointer,t,I(_),r.pointer,k(i),s)}strokePath(e,t,_,r,i,s){d(e,Path),d(t,StrokeState),f(_),d(r,ColorSpace),c(i),n._wasm_stroke_path(this.pointer,e.pointer,t.pointer,I(_),r.pointer,k(i),s)}clipPath(e,t,_){d(e,Path),f(_),n._wasm_clip_path(this.pointer,e.pointer,t,I(_))}clipStrokePath(e,t,_){d(e,Path),d(t,StrokeState),f(_),n._wasm_clip_stroke_path(this.pointer,e.pointer,t.pointer,I(_))}fillText(e,t,_,r,i){d(e,Text),f(t),d(_,ColorSpace),c(r),n._wasm_fill_text(this.pointer,e.pointer,I(t),_.pointer,k(r),i)}strokeText(e,t,_,r,i,s){d(e,Text),d(t,StrokeState),f(_),d(r,ColorSpace),c(i),n._wasm_stroke_text(this.pointer,e.pointer,t.pointer,I(_),r.pointer,k(i),s)}clipText(e,t){d(e,Text),f(t),n._wasm_clip_text(this.pointer,e.pointer,I(t))}clipStrokeText(e,t,_){d(e,Text),d(t,StrokeState),f(_),n._wasm_clip_stroke_text(this.pointer,e.pointer,t.pointer,I(_))}ignoreText(e,t){d(e,Text),f(t),n._wasm_ignore_text(this.pointer,e.pointer,I(t))}fillShade(e,t,_){d(e,Shade),f(t),n._wasm_fill_shade(this.pointer,e.pointer,I(t),_)}fillImage(e,t,_){d(e,Image),f(t),n._wasm_fill_image(this.pointer,e.pointer,I(t),_)}fillImageMask(e,t,_,r,i){d(e,Image),f(t),d(_,ColorSpace),c(r),n._wasm_fill_image_mask(this.pointer,e.pointer,I(t),_.pointer,k(r),i)}clipImageMask(e,t){d(e,Image),f(t),n._wasm_clip_image_mask(this.pointer,e.pointer,I(t))}popClip(){n._wasm_pop_clip(this.pointer)}beginMask(e,t,_,r){h(e),d(_,ColorSpace),c(r),n._wasm_begin_mask(this.pointer,T(e),t,_.pointer,k(r))}endMask(){n._wasm_end_mask(this.pointer)}beginGroup(e,t,_,r,i,s){h(e),d(t,ColorSpace);let o=P(i,Device.BLEND_MODES);n._wasm_begin_group(this.pointer,T(e),t.pointer,_,r,o,s)}endGroup(){n._wasm_end_group(this.pointer)}beginTile(e,t,_,r,i,s){return h(e),h(t),f(i),n._wasm_begin_tile(this.pointer,T(e),(a=t,n.HEAPF32[o+4]=a[0],n.HEAPF32[o+5]=a[1],n.HEAPF32[o+6]=a[2],n.HEAPF32[o+7]=a[3],o+4<<2),_,r,I(i),s);var a}endTile(){n._wasm_end_tile(this.pointer)}beginLayer(e){n._wasm_begin_layer(this.pointer,F(e))}endLayer(){n._wasm_end_layer(this.pointer)}close(){n._wasm_close_device(this.pointer)}}Device._drop=n._wasm_drop_device,Device.BLEND_MODES=["Normal","Multiply","Screen","Overlay","Darken","Lighten","ColorDodge","ColorBurn","HardLight","SoftLight","Difference","Exclusion","Hue","Saturation","Color","Luminosity"];export class DrawDevice extends Device{constructor(e,t){f(e),d(t,Pixmap),super(n._wasm_new_draw_device(I(e),t.pointer))}}export class DisplayListDevice extends Device{constructor(e){d(e,DisplayList),super(n._wasm_new_display_list_device(e.pointer))}}export class DocumentWriter extends W{constructor(e,t,_){super(n._wasm_new_document_writer_with_buffer(D(e),F(t),E(_)))}beginPage(e){return h(e),new Device(n._wasm_keep_device(n._wasm_begin_page(this.pointer,T(e))))}endPage(){n._wasm_end_page(this.pointer)}close(){n._wasm_close_document_writer(this.pointer)}}DocumentWriter._drop=n._wasm_drop_document_writer;export class Document extends W{static openDocument(e,_){let r=0,i=!1;if("string"==typeof e){if(_=e,!t)throw new Error("missing 'fs' module");e=t.readFileSync(e)}else void 0===_&&(_="application/pdf");if(d(_,"string"),(e instanceof ArrayBuffer||e instanceof Uint8Array)&&(e=new Buffer(e),i=!0),e instanceof Buffer)r=n._wasm_open_document_with_buffer(F(_),e.pointer);else{if(!(e instanceof Stream))throw new Error("not a Buffer or Stream");r=n._wasm_open_document_with_stream(F(_),e.pointer)}i&&e.destroy();let s=n._wasm_pdf_document_from_fz_document(r);return s?new PDFDocument(s):new Document(r)}formatLinkURI(e){return B(n._wasm_format_link_uri(this.pointer,0|e.chapter,0|e.page,P(e.type,Document.LINK_DEST),+e.x,+e.y,+e.width,+e.height,+e.zoom))}asPDF(){return this instanceof PDFDocument?this:null}isPDF(){return this instanceof PDFDocument}needsPassword(){return!!n._wasm_needs_password(this.pointer)}authenticatePassword(e){return n._wasm_authenticate_password(this.pointer,F(e))}hasPermission(e){let t=Document.PERMISSION[e];return!!n._wasm_has_permission(this.pointer,t)}getMetaData(e){let t=n._wasm_lookup_metadata(this.pointer,F(e));if(t)return v(t)}setMetaData(e,t){n._wasm_set_metadata(this.pointer,F(e),E(t))}countPages(){return n._wasm_count_pages(this.pointer)}isReflowable(){n._wasm_is_document_reflowable(this.pointer)}layout(e,t,_){n._wasm_layout_document(this.pointer,e,t,_)}loadPage(e){let t=n._wasm_load_page(this.pointer,e);if(this instanceof PDFDocument){let e=n._wasm_pdf_page_from_fz_page(t);if(e)return new PDFPage(this,e)}return new Page(t)}loadOutline(){let e=this.pointer;let t=n._wasm_load_outline(e);return t?function t(_){let r=[];for(;_;){let i=n._wasm_outline_get_title(_),s=n._wasm_outline_get_uri(_),o=n._wasm_outline_get_is_open(_),a={title:i?v(i):void 0,uri:s?v(s):void 0,open:!!o},p=n._wasm_outline_get_page(e,_);p>=0&&(a.page=p);let m=n._wasm_outline_get_down(_);m&&(a.down=t(m)),r.push(a),_=n._wasm_outline_get_next(_)}return r}(t):null}resolveLink(e){return e instanceof Link?n._wasm_resolve_link(this.pointer,n._wasm_link_get_uri(e.pointer)):n._wasm_resolve_link(this.pointer,F(e))}resolveLinkDestination(e){let t;return t=e instanceof Link?n._wasm_resolve_link_dest(this.pointer,n._wasm_link_get_uri(e.pointer)):n._wasm_resolve_link_dest(this.pointer,F(e)),{type:Document.LINK_DEST[n._wasm_link_dest_get_type(t)],chapter:n._wasm_link_dest_get_chapter(t),page:n._wasm_link_dest_get_page(t),x:n._wasm_link_dest_get_x(t),y:n._wasm_link_dest_get_y(t),width:n._wasm_link_dest_get_w(t),height:n._wasm_link_dest_get_h(t),zoom:n._wasm_link_dest_get_zoom(t)}}outlineIterator(){return new OutlineIterator(n._wasm_new_outline_iterator(this.pointer))}}Document._drop=n._wasm_drop_document,Document.META_FORMAT="format",Document.META_ENCRYPTION="encryption",Document.META_INFO_AUTHOR="info:Author",Document.META_INFO_TITLE="info:Title",Document.META_INFO_SUBJECT="info:Subject",Document.META_INFO_KEYWORDS="info:Keywords",Document.META_INFO_CREATOR="info:Creator",Document.META_INFO_PRODUCER="info:Producer",Document.META_INFO_CREATIONDATE="info:CreationDate",Document.META_INFO_MODIFICATIONDATE="info:ModDate",Document.PERMISSION={print:"p".charCodeAt(0),copy:"c".charCodeAt(0),edit:"e".charCodeAt(0),annotate:"n".charCodeAt(0),form:"f".charCodeAt(0),accessibility:"y".charCodeAt(0),assemble:"a".charCodeAt(0),"print-hq":"h".charCodeAt(0)},Document.LINK_DEST=["Fit","FitB","FitH","FitBH","FitV","FitBV","FitR","XYZ"];export class OutlineIterator extends W{item(){let e=n._wasm_outline_iterator_item(this.pointer);if(e){let t=n._wasm_outline_item_get_title(e),_=n._wasm_outline_item_get_uri(e),r=n._wasm_outline_item_get_is_open(e);return{title:t?v(t):void 0,uri:_?v(_):void 0,open:!!r}}return null}next(){return n._wasm_outline_iterator_next(this.pointer)}prev(){return n._wasm_outline_iterator_prev(this.pointer)}up(){return n._wasm_outline_iterator_up(this.pointer)}down(){return n._wasm_outline_iterator_down(this.pointer)}delete(){return n._wasm_outline_iterator_delete(this.pointer)}insert(e){return n._wasm_outline_iterator_insert(this.pointer,y(e.title),x(e.uri),e.open)}update(e){n._wasm_outline_iterator_update(this.pointer,y(e.title),x(e.uri),e.open)}}OutlineIterator._drop=n._wasm_drop_outline_iterator,OutlineIterator.RESULT_DID_NOT_MOVE=-1,OutlineIterator.RESULT_AT_ITEM=0,OutlineIterator.RESULT_AT_EMPTY=1;export class Link extends W{getBounds(){return j(n._wasm_link_get_rect(this.pointer))}setBounds(e){h(e),n._wasm_link_set_rect(this.pointer,T(e))}getURI(){return v(n._wasm_link_get_uri(this.pointer))}setURI(e){d(e,"string"),n._wasm_link_set_uri(this.pointer,F(e))}isExternal(){return/^\w[\w+-.]*:/.test(this.getURI())}}Link._drop=n._wasm_drop_link;export class Page extends W{isPDF(){return this instanceof PDFPage}getBounds(e="CropBox"){let t=P(e,Page.BOXES);return j(n._wasm_bound_page(this.pointer,t))}getLabel(){return v(n._wasm_page_label(this.pointer))}run(e,t){d(e,Device),f(t),n._wasm_run_page(this.pointer,e.pointer,I(t))}runPageContents(e,t){d(e,Device),f(t),n._wasm_run_page_contents(this.pointer,e.pointer,I(t))}runPageAnnots(e,t){d(e,Device),f(t),n._wasm_run_page_annots(this.pointer,e.pointer,I(t))}runPageWidgets(e,t){d(e,Device),f(t),n._wasm_run_page_widgets(this.pointer,e.pointer,I(t))}toPixmap(e,t,_=!1,r=!0){let i;return d(t,ColorSpace),f(e),i=r?n._wasm_new_pixmap_from_page(this.pointer,I(e),t.pointer,_):n._wasm_new_pixmap_from_page_contents(this.pointer,I(e),t.pointer,_),new Pixmap(i)}toDisplayList(e=!0){let t;return t=e?n._wasm_new_display_list_from_page(this.pointer):n._wasm_new_display_list_from_page_contents(this.pointer),new DisplayList(t)}toStructuredText(e=""){return d(e,"string"),new StructuredText(n._wasm_new_stext_page_from_page(this.pointer,F(e)))}getLinks(){let e=[],t=n._wasm_load_links(this.pointer);for(;t;)e.push(new Link(n._wasm_keep_link(t))),t=n._wasm_link_get_next(t);return e}createLink(e,t){return h(e),new Link(n._wasm_create_link(this.pointer,T(e),F(t)))}deleteLink(e){d(e,Link),n._wasm_delete_link(this.pointer,e.pointer)}search(e,t=500){return U(n._wasm_search_page,this.pointer,e,t)}}Page._drop=n._wasm_drop_page,Page.BOXES=["MediaBox","CropBox","BleedBox","TrimBox","ArtBox"];export class PDFDocument extends Document{constructor(e){if(void 0===e)super(n._wasm_pdf_create_document());else if("number"==typeof e)super(e);else{if(!(e instanceof PDFDocument)){let t=Document.openDocument(e,"application/pdf");if(t instanceof PDFDocument)return t;throw new Error("not a PDF document")}super(e.pointer),n._wasm_keep_document(this.pointer)}}loadPage(e){return super.loadPage(e)}_fromPDFObjectNew(e){return 0===e?PDFObject.Null:new PDFObject(this,e)}_fromPDFObjectKeep(e){return 0===e?PDFObject.Null:new PDFObject(this,n._wasm_pdf_keep_obj(e))}_toPDFObject(e){if(e instanceof PDFObject)return e;if(null==e)return this.newNull();if("string"==typeof e)return e.startsWith("(")&&e.endsWith(")")?this.newString(e.slice(1,-1)):this.newName(e);if("number"==typeof e)return e===(0|e)?this.newInteger(e):this.newReal(e);if("boolean"==typeof e)return this.newBoolean(e);if(e instanceof Array){let t=this.newArray();for(let n of e)t.push(n);return t}if(e instanceof Object){let t=this.newDictionary();for(let n in e)t.put(n,e[n]);return t}throw new TypeError("cannot convert value to PDFObject")}_PDFOBJ(e){return this._toPDFObject(e).pointer}getVersion(){return n._wasm_pdf_version(this.pointer)}getLanguage(){return N(n._wasm_pdf_document_language(this.pointer))}setLanguage(e){n._wasm_pdf_set_document_language(this.pointer,F(e))}countObjects(){return n._wasm_pdf_xref_len(this.pointer)}getTrailer(){return new PDFObject(this,n._wasm_pdf_trailer(this.pointer))}createObject(){let e=n._wasm_pdf_create_object(this.pointer);return this._fromPDFObjectNew(n._wasm_pdf_new_indirect(this.pointer,e))}newNull(){return PDFObject.Null}newBoolean(e){return this._fromPDFObjectNew(n._wasm_pdf_new_bool(e))}newInteger(e){return this._fromPDFObjectNew(n._wasm_pdf_new_int(e))}newReal(e){return this._fromPDFObjectNew(n._wasm_pdf_new_real(e))}newName(e){return this._fromPDFObjectNew(n._wasm_pdf_new_name(F(e)))}newString(e){return this._fromPDFObjectNew(n._wasm_pdf_new_text_string(F(e)))}newByteString(e){e instanceof Array&&(e=Uint8Array.from(e)),d(e,Uint8Array);let t=e.byteLength,i=_(t);n.HEAPU8.set(e,i);try{return this._fromPDFObjectNew(n._wasm_pdf_new_string(i,t))}finally{r(i)}}newIndirect(e){return this._fromPDFObjectNew(n._wasm_pdf_new_indirect(this.pointer,e))}newArray(){return this._fromPDFObjectNew(n._wasm_pdf_new_array(this.pointer))}newDictionary(){return this._fromPDFObjectNew(n._wasm_pdf_new_dict(this.pointer))}deleteObject(e){e instanceof PDFObject?e=e.asIndirect():d(e,"number"),n._wasm_pdf_delete_object(this.pointer,e)}addObject(e){return this._fromPDFObjectNew(n._wasm_pdf_add_object(this.pointer,this._PDFOBJ(e)))}addStream(e,t){return this._fromPDFObjectNew(n._wasm_pdf_add_stream(this.pointer,D(e),this._PDFOBJ(t),0))}addRawStream(e,t){return this._fromPDFObjectNew(n._wasm_pdf_add_stream(this.pointer,D(e),this._PDFOBJ(t),1))}newGraftMap(){return new PDFGraftMap(this,n._wasm_pdf_new_graft_map(this.pointer))}graftObject(e){return d(e,PDFObject),this._fromPDFObjectNew(n._wasm_pdf_graft_object(this.pointer,e.pointer))}graftPage(e,t,_){d(e,"number"),d(t,PDFDocument),d(_,"number"),n._wasm_pdf_graft_page(this.pointer,e,t.pointer,_)}addSimpleFont(e,t="Latin"){d(e,Font);var _=P(t,Font.SIMPLE_ENCODING);return this._fromPDFObjectNew(n._wasm_pdf_add_simple_font(this.pointer,e.pointer,_))}addCJKFont(e,t,_=0,r=!0){return d(e,Font),"string"==typeof t&&(t=Font.CJK_ORDERING_BY_LANG[t]),this._fromPDFObjectNew(n._wasm_pdf_add_cjk_font(this.pointer,e.pointer,t,_,r))}addFont(e){return d(e,Font),this._fromPDFObjectNew(n._wasm_pdf_add_cid_font(this.pointer,e.pointer))}addImage(e){return d(e,Image),this._fromPDFObjectNew(n._wasm_pdf_add_image(this.pointer,e.pointer))}loadImage(e){return d(e,PDFObject),new Image(n._wasm_pdf_load_image(this.pointer,e.pointer))}findPage(e){return d(e,"number"),this._fromPDFObjectKeep(n._wasm_pdf_lookup_page_obj(this.pointer,e))}addPage(e,t,_,r){return h(e),d(t,"number"),this._fromPDFObjectNew(n._wasm_pdf_add_page(this.pointer,T(e),t,this._PDFOBJ(_),D(r)))}insertPage(e,t){d(e,"number"),n._wasm_pdf_insert_page(this.pointer,e,this._PDFOBJ(t))}deletePage(e){d(e,"number"),n._wasm_pdf_delete_page(this.pointer,e)}isEmbeddedFile(e){return d(e,PDFObject),!!n._wasm_pdf_is_embedded_file(e.pointer)}addEmbeddedFile(e,t,_,r,i,s=!1){return d(e,"string"),d(t,"string"),d(r,Date),d(i,Date),d(s,"boolean"),this._fromPDFObjectNew(n._wasm_pdf_add_embedded_file(this.pointer,F(e),E(t),D(_),r.getTime()/1e3|0,i.getTime()/1e3|0,s))}getFilespecParams(e){d(e,PDFObject);let t=n._wasm_pdf_get_filespec_params(e.pointer);return{filename:v(n._wasm_pdf_filespec_params_get_filename(t)),mimetype:v(n._wasm_pdf_filespec_params_get_mimetype(t)),size:n._wasm_pdf_filespec_params_get_filename(t),creationDate:new Date(1e3*n._wasm_pdf_filespec_params_get_created(t)),modificationDate:new Date(1e3*n._wasm_pdf_filespec_params_get_modified(t))}}getEmbeddedFileContents(e){d(e,PDFObject);let t=n._wasm_pdf_load_embedded_file_contents(e.pointer);return t?new Buffer(t):null}getEmbeddedFiles(){return function e(t,n){var _,r;if(n.isDictionary()){var i=n.get("Names");if(i)for(_=0,r=i.length;_<r;_+=2)t[i.get(_+0).asString()]=i.get(_+1);var s=n.get("Kids");if(s)for(_=0,r=s.length;_<r;_+=1)e(t,s.get(_))}return t}({},this.getTrailer().get("Root","Names","EmbeddedFiles"))}loadNameTree(e){var t=this.getTrailer().get("Root").get("Names").get(e),n={};return t.isDictionary()&&function e(t,n){var _=n.get("Kids");if(_&&_.isArray())for(var r=0;r<_.length;r+=1)e(t,_.get(r));var i=n.get("Names");if(i&&i.isArray())for(r=0;r<i.length;r+=2)t[i.get(r).asString()]=i.get(r+1)}(n,t),n}insertEmbeddedFile(e,t){var n=this.getEmbeddedFiles();n[e]=t,this._rewriteEmbeddedFiles(n)}deleteEmbeddedFile(e){var t=this.getEmbeddedFiles();delete t[e],this._rewriteEmbeddedFiles(t)}_rewriteEmbeddedFiles(e){var t=Object.keys(e);t.sort();var n=this.getTrailer().get("Root"),_=n.get("Names");_.isDictionary()||(_=n.put("Names",this.newDictionary()));var r=_.put("EmbeddedFiles",this.newDictionary()).put("Names",this.newArray());for(var i of t)r.push(this.newString(i)),r.push(e[i])}saveToBuffer(e=""){var t;return t="object"==typeof e?Object.entries(e).map((e=>{var t=e[0],n=e[1];return!0===n?t+"=yes":!1===n?t+"=no":t+"="+String(n).replaceAll(",",":")})).join(","):e,new Buffer(n._wasm_pdf_write_document_buffer(this.pointer,F(t)))}save(e,n=""){if(!t)throw new Error("missing 'fs' module");t.writeFileSync(e,this.saveToBuffer(n).asUint8Array())}setPageLabels(e,t="D",_="",r=1){n._wasm_pdf_set_page_labels(this.pointer,e,t.charCodeAt(0),F(_),r)}deletePageLabels(e){n._wasm_pdf_delete_page_labels(this.pointer,e)}wasRepaired(){return!!n._wasm_pdf_was_repaired(this.pointer)}hasUnsavedChanges(){return!!n._wasm_pdf_has_unsaved_changes(this.pointer)}countVersions(){return n._wasm_pdf_count_versions(this.pointer)}countUnsavedVersions(){return n._wasm_pdf_count_unsaved_versions(this.pointer)}validateChangeHistory(){return n._wasm_pdf_validate_change_history(this.pointer)}canBeSavedIncrementally(){return!!n._wasm_pdf_can_be_saved_incrementally(this.pointer)}enableJournal(){n._wasm_pdf_enable_journal(this.pointer)}getJournal(){let e=n._wasm_pdf_undoredo_state_position(this.pointer),t=n._wasm_pdf_undoredo_state_count(this.pointer),_=[];for(let e=0;e<t;++e)_.push(v(n._wasm_pdf_undoredo_step(this.pointer,e)));return{position:e,steps:_}}beginOperation(e){n._wasm_pdf_begin_operation(this.pointer,F(e))}beginImplicitOperation(){n._wasm_pdf_begin_implicit_operation(this.pointer)}endOperation(){n._wasm_pdf_end_operation(this.pointer)}abandonOperation(){n._wasm_pdf_abandon_operation(this.pointer)}canUndo(){return!!n._wasm_pdf_can_undo(this.pointer)}canRedo(){return!!n._wasm_pdf_can_redo(this.pointer)}undo(){n._wasm_pdf_undo(this.pointer)}redo(){n._wasm_pdf_redo(this.pointer)}isJSSupported(){return!!n._wasm_pdf_js_supported(this.pointer)}enableJS(){n._wasm_pdf_enable_js(this.pointer)}disableJS(){n._wasm_pdf_disable_js(this.pointer)}setJSEventListener(e){throw"TODO"}rearrangePages(e){let t=e.length,i=_(t<<2);for(let _=0;_<t;++_)n.HEAPU32[(i>>2)+_]=e[_]||0;try{n._wasm_pdf_rearrange_pages(this.pointer,t,i)}finally{r(i)}}subsetFonts(){n._wasm_pdf_subset_fonts(this.pointer)}bake(e=!0,t=!0){n._wasm_pdf_bake_document(this.pointer,e,t)}countLayers(){return n._wasm_pdf_count_layers(this.pointer)}isLayerVisible(e){return!!n._wasm_pdf_layer_is_enabled(this.pointer,e)}setLayerVisible(e,t){n._wasm_pdf_enable_layer(this.pointer,e,Number(t))}getLayerName(e){return v(n._wasm_pdf_layer_name(this.pointer,e))}resetForm(e,t){n._wasm_pdf_reset_form(this.pointer,this._PDFOBJ(e),Number(t))}}PDFDocument.PAGE_LABEL_NONE="\0",PDFDocument.PAGE_LABEL_DECIMAL="D",PDFDocument.PAGE_LABEL_ROMAN_UC="R",PDFDocument.PAGE_LABEL_ROMAN_LC="r",PDFDocument.PAGE_LABEL_ALPHA_UC="A",PDFDocument.PAGE_LABEL_ALPHA_LC="a";export class PDFPage extends Page{constructor(e,t){super(t),this._doc=e,this._annots=null,this._widgets=null}getObject(){return this._doc._fromPDFObjectKeep(n._wasm_pdf_page_get_obj(this.pointer))}getTransform(){return H(n._wasm_pdf_page_transform(this.pointer))}setPageBox(e,t){let _=P(e,Page.BOXES);h(t),n._wasm_pdf_set_page_box(this.pointer,_,T(t))}toPixmap(e,t,_=!1,r=!0,i="View",s="CropBox"){f(e),d(t,ColorSpace);let o,a=P(s,Page.BOXES);return o=r?n._wasm_pdf_new_pixmap_from_page_with_usage(this.pointer,I(e),t.pointer,_,F(i),a):n._wasm_pdf_new_pixmap_from_page_contents_with_usage(this.pointer,I(e),t.pointer,_,F(i),a),new Pixmap(o)}getWidgets(){if(!this._widgets){this._widgets=[];let e=n._wasm_pdf_first_widget(this.pointer);for(;e;)this._widgets.push(new PDFWidget(this._doc,n._wasm_pdf_keep_annot(e))),e=n._wasm_pdf_next_widget(e)}return this._widgets}getAnnotations(){if(!this._annots){this._annots=[];let e=n._wasm_pdf_first_annot(this.pointer);for(;e;)this._annots.push(new PDFAnnotation(this._doc,n._wasm_pdf_keep_annot(e))),e=n._wasm_pdf_next_annot(e)}return this._annots}createAnnotation(e){let t=P(e,PDFAnnotation.ANNOT_TYPES),_=new PDFAnnotation(this._doc,n._wasm_pdf_create_annot(this.pointer,t));return this._annots&&this._annots.push(_),_}deleteAnnotation(e){if(d(e,PDFAnnotation),n._wasm_pdf_delete_annot(this.pointer,e.pointer),this._annots){let t=this._annots.indexOf(e);t>=0&&this._annots.splice(t,1)}}applyRedactions(e=!0,t=2,_=1,r=0){n._wasm_pdf_redact_page(this.pointer,Number(e),t,_,r)}update(){return!!n._wasm_pdf_update_page(this.pointer)}}PDFPage.REDACT_IMAGE_NONE=0,PDFPage.REDACT_IMAGE_REMOVE=1,PDFPage.REDACT_IMAGE_PIXELS=2,PDFPage.REDACT_IMAGE_UNLESS_INVISIBLE=3,PDFPage.REDACT_LINE_ART_NONE=0,PDFPage.REDACT_LINE_ART_REMOVE_IF_COVERED=1,PDFPage.REDACT_LINE_ART_REMOVE_IF_TOUCHED=2,PDFPage.REDACT_TEXT_REMOVE=0,PDFPage.REDACT_TEXT_NONE=1;export class PDFObject extends W{constructor(e,t){super(n._wasm_pdf_keep_obj(t)),this._doc=e}isNull(){return this===PDFObject.Null}isIndirect(){return!!n._wasm_pdf_is_indirect(this.pointer)}isBoolean(){return!!n._wasm_pdf_is_bool(this.pointer)}isInteger(){return!!n._wasm_pdf_is_int(this.pointer)}isReal(){return!!n._wasm_pdf_is_real(this.pointer)}isNumber(){return!!n._wasm_pdf_is_number(this.pointer)}isName(){return!!n._wasm_pdf_is_name(this.pointer)}isString(){return!!n._wasm_pdf_is_string(this.pointer)}isArray(){return!!n._wasm_pdf_is_array(this.pointer)}isDictionary(){return!!n._wasm_pdf_is_dict(this.pointer)}isStream(){return!!n._wasm_pdf_is_stream(this.pointer)}asIndirect(){return n._wasm_pdf_to_num(this.pointer)}asBoolean(){return!!n._wasm_pdf_to_bool(this.pointer)}asNumber(){return n._wasm_pdf_to_real(this.pointer)}asName(){return v(n._wasm_pdf_to_name(this.pointer))}asString(){return v(n._wasm_pdf_to_text_string(this.pointer))}asByteString(){let e=n._wasm_pdf_to_string(this.pointer,i),t=n.HEAPU32[i>>2];return n.HEAPU8.slice(e,e+t)}readStream(){return new Buffer(n._wasm_pdf_load_stream(this.pointer))}readRawStream(){return new Buffer(n._wasm_pdf_load_raw_stream(this.pointer))}writeObject(e){if(!this.isIndirect())throw new TypeError("can only call PDFObject.writeObject on an indirect reference");n._wasm_pdf_update_object(this._doc.pointer,this.asIndirect(),this._doc._PDFOBJ(e))}writeStream(e){if(!this.isIndirect())throw new TypeError("can only call PDFObject.writeStream on an indirect reference");n._wasm_pdf_update_stream(this._doc.pointer,this.pointer,D(e),0)}writeRawStream(e){if(!this.isIndirect())throw new TypeError("can only call PDFObject.writeRawStream on an indirect reference");n._wasm_pdf_update_stream(this._doc.pointer,this.pointer,D(e),1)}resolve(){return this._doc._fromPDFObjectKeep(n._wasm_pdf_resolve_indirect(this.pointer))}get length(){return n._wasm_pdf_array_len(this.pointer)}set length(e){throw new TypeError("object length is read-only")}_get(e){let t=this.pointer;for(let _ of e)if(t="number"==typeof _?n._wasm_pdf_array_get(t,_):_ instanceof PDFObject?n._wasm_pdf_dict_get(t,_.pointer):n._wasm_pdf_dict_gets(t,F(_)),0===t)break;return t}get(...e){return this._doc._fromPDFObjectKeep(this._get(e))}getInheritable(e){return e instanceof PDFObject?this._doc._fromPDFObjectKeep(n._wasm_pdf_dict_get_inheritable(this.pointer,e.pointer)):this._doc._fromPDFObjectKeep(n._wasm_pdf_dict_gets_inheritable(this.pointer,F(e)))}put(e,t){return t=this._doc._toPDFObject(t),"number"==typeof e?n._wasm_pdf_array_put(this.pointer,e,t.pointer):e instanceof PDFObject?n._wasm_pdf_dict_put(this.pointer,e.pointer,t.pointer):n._wasm_pdf_dict_puts(this.pointer,F(e),t.pointer),t}push(e){return e=this._doc._toPDFObject(e),n._wasm_pdf_array_push(this.pointer,e.pointer),e}delete(e){"number"==typeof e?n._wasm_pdf_array_delete(this.pointer,e):e instanceof PDFObject?n._wasm_pdf_dict_del(this.pointer,e.pointer):n._wasm_pdf_dict_dels(this.pointer,F(e))}valueOf(){return this.isNull()?null:this.isBoolean()?this.asBoolean():this.isNumber()?this.asNumber():this.isName()?this.asName():this.isString()?this.asString():this.isIndirect()?`${this.asIndirect()} 0 R`:this}toString(e=!0,t=!0){return B(n._wasm_pdf_sprint_obj(this.pointer,e,t))}forEach(e){if(this.isArray()){let t=this.length;for(let n=0;n<t;++n)e(this.get(n),n,this)}else if(this.isDictionary()){let t=n._wasm_pdf_dict_len(this.pointer);for(let _=0;_<t;++_){let t=this._doc._fromPDFObjectKeep(n._wasm_pdf_dict_get_key(this.pointer,_));e(this._doc._fromPDFObjectKeep(n._wasm_pdf_dict_get_val(this.pointer,_)),t.asName(),this)}}}asJS(e){if(this.isIndirect()){let t=this.asIndirect();return e?t in e?e[t]:(e[t]=PDFObject.Null,e[t]=this.resolve().asJS(e)):`${t} 0 R`}if(this.isArray()){let t=[];return this.forEach((n=>{t.push(n.asJS(e))})),t}if(this.isDictionary()){let t={};return this.forEach(((n,_)=>{t[_]=n.asJS(e)})),t}return this.valueOf()}}PDFObject._drop=n._wasm_pdf_drop_obj,PDFObject.Null=new PDFObject(null,0);export class PDFGraftMap extends W{constructor(e,t){super(t),this._doc=e}graftObject(e){return d(e,PDFObject),this._doc._fromPDFObjectNew(n._wasm_pdf_graft_mapped_object(this.pointer,e.pointer))}graftPage(e,t,_){d(e,"number"),d(t,PDFDocument),d(_,"number"),n._wasm_pdf_graft_mapped_page(this.pointer,e,t.pointer,_)}}PDFGraftMap._drop=n._wasm_pdf_drop_graft_map;export class PDFAnnotation extends W{constructor(e,t){super(t),this._doc=e}getObject(){return this._doc._fromPDFObjectKeep(n._wasm_pdf_annot_obj(this.pointer))}getBounds(){return j(n._wasm_pdf_bound_annot(this.pointer))}run(e,t){d(e,Device),f(t),n._wasm_pdf_run_annot(this.pointer,e.pointer,I(t))}toPixmap(e,t,_=!1){return f(e),d(t,ColorSpace),new Pixmap(n._wasm_pdf_new_pixmap_from_annot(this.pointer,I(e),t.pointer,_))}toDisplayList(){return new DisplayList(n._wasm_pdf_new_display_list_from_annot(this.pointer))}update(){return!!n._wasm_pdf_update_annot(this.pointer)}getType(){let e=n._wasm_pdf_annot_type(this.pointer);return PDFAnnotation.ANNOT_TYPES[e]||"Text"}getLanguage(){return N(n._wasm_pdf_annot_language(this.pointer))}setLanguage(e){n._wasm_pdf_set_annot_language(this.pointer,F(e))}getFlags(){return n._wasm_pdf_annot_flags(this.pointer)}setFlags(e){return n._wasm_pdf_set_annot_flags(this.pointer,e)}getContents(){return v(n._wasm_pdf_annot_contents(this.pointer))}setContents(e){n._wasm_pdf_set_annot_contents(this.pointer,F(e))}getAuthor(){return v(n._wasm_pdf_annot_author(this.pointer))}setAuthor(e){n._wasm_pdf_set_annot_author(this.pointer,F(e))}getCreationDate(){return new Date(1e3*n._wasm_pdf_annot_creation_date(this.pointer))}setCreationDate(e){d(e,Date),n._wasm_pdf_set_annot_creation_date(this.pointer,e.getTime()/1e3)}getModificationDate(){return new Date(1e3*n._wasm_pdf_annot_modification_date(this.pointer))}setModificationDate(e){d(e,Date),n._wasm_pdf_set_annot_modification_date(this.pointer,e.getTime()/1e3)}hasRect(){return!!n._wasm_pdf_annot_has_rect(this.pointer)}hasInkList(){return!!n._wasm_pdf_annot_has_ink_list(this.pointer)}hasQuadPoints(){return!!n._wasm_pdf_annot_has_quad_points(this.pointer)}hasVertices(){return!!n._wasm_pdf_annot_has_vertices(this.pointer)}hasLine(){return!!n._wasm_pdf_annot_has_line(this.pointer)}hasInteriorColor(){return!!n._wasm_pdf_annot_has_interior_color(this.pointer)}hasLineEndingStyles(){return!!n._wasm_pdf_annot_has_line_ending_styles(this.pointer)}hasBorder(){return!!n._wasm_pdf_annot_has_border(this.pointer)}hasBorderEffect(){return!!n._wasm_pdf_annot_has_border_effect(this.pointer)}hasIcon(){return!!n._wasm_pdf_annot_has_icon_name(this.pointer)}hasOpen(){return!!n._wasm_pdf_annot_has_open(this.pointer)}hasAuthor(){return!!n._wasm_pdf_annot_has_author(this.pointer)}hasFilespec(){return!!n._wasm_pdf_annot_has_filespec(this.pointer)}hasCallout(){return!!n._wasm_pdf_annot_has_callout(this.pointer)}hasRichContents(){return!!n._wasm_pdf_annot_has_rich_contents(this.pointer)}getRect(){return j(n._wasm_pdf_annot_rect(this.pointer))}setRect(e){h(e),n._wasm_pdf_set_annot_rect(this.pointer,T(e))}getPopup(){return j(n._wasm_pdf_annot_popup(this.pointer))}setPopup(e){h(e),n._wasm_pdf_set_annot_popup(this.pointer,T(e))}getIsOpen(){return!!n._wasm_pdf_annot_is_open(this.pointer)}setIsOpen(e){d(e,"boolean"),n._wasm_pdf_set_annot_is_open(this.pointer,e)}getHiddenForEditing(){return!!n._wasm_pdf_annot_hidden_for_editing(this.pointer)}setHiddenForEditing(e){d(e,"boolean"),n._wasm_pdf_set_annot_hidden_for_editing(this.pointer,e)}getIcon(){return v(n._wasm_pdf_annot_icon_name(this.pointer))}setIcon(e){d(e,"string"),n._wasm_pdf_set_annot_icon_name(this.pointer,F(e))}getOpacity(){return n._wasm_pdf_annot_opacity(this.pointer)}setOpacity(e){d(e,"number"),n._wasm_pdf_set_annot_opacity(this.pointer,e)}getQuadding(){return n._wasm_pdf_annot_quadding(this.pointer)}setQuadding(e){d(e,"number"),n._wasm_pdf_set_annot_quadding(this.pointer,e)}getLine(){return[R(n._wasm_pdf_annot_line_1(this.pointer)),R(n._wasm_pdf_annot_line_2(this.pointer))]}setLine(e,t){u(e),u(t),n._wasm_pdf_set_annot_line(this.pointer,S(e),A(t))}getLineEndingStyles(){let e=n._wasm_pdf_annot_line_ending_styles_start(this.pointer),t=n._wasm_pdf_annot_line_ending_styles_end(this.pointer);return{start:PDFAnnotation.LINE_ENDING[e]||"None",end:PDFAnnotation.LINE_ENDING[t]||"None"}}setLineEndingStyles(e,t){let _=P(e,PDFAnnotation.LINE_ENDING),r=P(t,PDFAnnotation.LINE_ENDING);n._wasm_pdf_set_annot_line_ending_styles(this.pointer,_,r)}getLineCaption(){return n._wasm_pdf_annot_line_caption(this.pointer)}setLineCaption(e){return n._wasm_pdf_set_annot_line_caption(this.pointer,e)}getLineCaptionOffset(){return R(n._wasm_pdf_annot_line_caption_offset(this.pointer))}setLineCaptionOffset(e){return n._wasm_pdf_set_annot_line_caption_offset(this.pointer,S(e))}getLineLeader(){return n._wasm_pdf_annot_line_leader(this.pointer)}getLineLeaderExtension(){return n._wasm_pdf_annot_line_leader_extension(this.pointer)}getLineLeaderOffset(){return n._wasm_pdf_annot_line_leader_offset(this.pointer)}setLineLeader(e){return n._wasm_pdf_set_annot_line_leader(this.pointer,e)}setLineLeaderExtension(e){return n._wasm_pdf_set_annot_line_leader_extension(this.pointer,e)}setLineLeaderOffset(e){return n._wasm_pdf_set_annot_line_leader_offset(this.pointer,e)}getCalloutStyle(){let e=n._wasm_pdf_annot_callout_style(this.pointer);return PDFAnnotation.LINE_ENDING[e]||"None"}setCalloutStyle(e){let t=P(e,PDFAnnotation.LINE_ENDING);n._wasm_pdf_set_annot_callout_style(this.pointer,t)}getCalloutLine(){let e=n._wasm_pdf_annot_callout_line(this.pointer,s<<2);return 3==e?[R(s+0<<2),R(s+1<<2),R(s+2<<2)]:2==e?[R(s+0<<2),R(s+1<<2)]:null}setCalloutLine(e){let t=e[0]||[0,0],_=e[1]||[0,0],r=e[2]||[0,0];var i;n._wasm_pdf_set_annot_callout_line(this.pointer,e.length,S(t),A(_),(i=r,n.HEAPF32[s+4]=i[0],n.HEAPF32[s+5]=i[1],s+4<<2))}getCalloutPoint(){let e=this.getCalloutLine();if(e)return e[0]}setCalloutPoint(e){n._wasm_pdf_set_annot_callout_point(this.pointer,S(e))}getColor(){return L(n._wasm_pdf_annot_color(this.pointer,k()))}getInteriorColor(){return L(n._wasm_pdf_annot_interior_color(this.pointer,k()))}setColor(e){g(e),n._wasm_pdf_set_annot_color(this.pointer,e.length,k(e))}setInteriorColor(e){g(e),n._wasm_pdf_set_annot_interior_color(this.pointer,e.length,k(e))}getBorderWidth(){return n._wasm_pdf_annot_border_width(this.pointer)}setBorderWidth(e){return d(e,"number"),n._wasm_pdf_set_annot_border_width(this.pointer,e)}getBorderStyle(){return PDFAnnotation.BORDER_STYLE[n._wasm_pdf_annot_border_style(this.pointer)]||"Solid"}setBorderStyle(e){let t=P(e,PDFAnnotation.BORDER_STYLE);return n._wasm_pdf_set_annot_border_style(this.pointer,t)}getBorderEffect(){return PDFAnnotation.BORDER_EFFECT[n._wasm_pdf_annot_border_effect(this.pointer)]||"None"}setBorderEffect(e){let t=P(e,PDFAnnotation.BORDER_EFFECT);return n._wasm_pdf_set_annot_border_effect(this.pointer,t)}getBorderEffectIntensity(){return n._wasm_pdf_annot_border_effect_intensity(this.pointer)}setBorderEffectIntensity(e){return d(e,"number"),n._wasm_pdf_set_annot_border_effect_intensity(this.pointer,e)}getBorderDashCount(){return n._wasm_pdf_annot_border_dash_count(this.pointer)}getBorderDashItem(e){return n._wasm_pdf_annot_border_dash_item(this.pointer,e)}clearBorderDash(){n._wasm_pdf_clear_annot_border_dash(this.pointer)}addBorderDashItem(e){return d(e,"number"),n._wasm_pdf_add_annot_border_dash_item(this.pointer,e)}getBorderDashPattern(){let e=this.getBorderDashCount(),t=new Array(e);for(let n=0;n<e;++n)t[n]=this.getBorderDashItem(n);return t}setBorderDashPattern(e){this.clearBorderDash();for(let t of e)this.addBorderDashItem(t)}getIntent(){return PDFAnnotation.INTENT[n._wasm_pdf_annot_intent(this.pointer)]||null}setIntent(e){let t=P(e,PDFAnnotation.INTENT);return n._wasm_pdf_set_annot_intent(this.pointer,t)}setDefaultAppearance(e,t,_){d(e,"string"),d(t,"number"),g(_),n._wasm_pdf_set_annot_default_appearance(this.pointer,F(e),t,_.length,k(_))}getDefaultAppearance(){return{font:v(n._wasm_pdf_annot_default_appearance_font(this.pointer)),size:n._wasm_pdf_annot_default_appearance_size(this.pointer),color:L(n._wasm_pdf_annot_default_appearance_color(this.pointer,k()))}}getFileSpec(){return this._doc._fromPDFObjectKeep(n._wasm_pdf_annot_filespec(this.pointer))}setFileSpec(e){return n._wasm_pdf_set_annot_filespec(this.pointer,this._doc._PDFOBJ(e))}getQuadPoints(){let e=n._wasm_pdf_annot_quad_point_count(this.pointer),t=[];for(let _=0;_<e;++_)t.push(M(n._wasm_pdf_annot_quad_point(this.pointer,_)));return t}clearQuadPoints(){n._wasm_pdf_clear_annot_quad_points(this.pointer)}addQuadPoint(e){w(e),n._wasm_pdf_add_annot_quad_point(this.pointer,O(e))}setQuadPoints(e){this.clearQuadPoints();for(let t of e)this.addQuadPoint(t)}getVertices(){let e=n._wasm_pdf_annot_vertex_count(this.pointer),t=new Array(e);for(let _=0;_<e;++_)t[_]=R(n._wasm_pdf_annot_vertex(this.pointer,_));return t}clearVertices(){n._wasm_pdf_clear_annot_vertices(this.pointer)}addVertex(e){u(e),n._wasm_pdf_add_annot_vertex(this.pointer,S(e))}setVertices(e){this.clearVertices();for(let t of e)this.addVertex(t)}getInkList(){let e=n._wasm_pdf_annot_ink_list_count(this.pointer),t=[];for(let _=0;_<e;++_){let e=n._wasm_pdf_annot_ink_list_stroke_count(this.pointer,_),r=new Array(e);for(let t=0;t<e;++t)r[t]=R(n._wasm_pdf_annot_ink_list_stroke_vertex(this.pointer,_,t));t.push(r)}return t}clearInkList(){n._wasm_pdf_clear_annot_ink_list(this.pointer)}addInkListStroke(){n._wasm_pdf_add_annot_ink_list_stroke(this.pointer)}addInkListStrokeVertex(e){u(e),n._wasm_pdf_add_annot_ink_list_stroke_vertex(this.pointer,S(e))}setInkList(e){this.clearInkList();for(let t of e){this.addInkListStroke();for(let e of t)this.addInkListStrokeVertex(e)}}getRichContents(){return v(n._wasm_pdf_annot_rich_contents(this.pointer))}setRichContents(e,t){d(e,"string"),d(t,"string"),n._wasm_pdf_set_annot_rich_contents(this.pointer,F(e),E(t))}getRichDefaults(){return v(n._wasm_pdf_annot_rich_defaults(this.pointer))}setRichDefaults(e){d(e,"string"),n._wasm_pdf_set_annot_rich_defaults(this.pointer,F(e))}setStampImage(e){n._wasm_pdf_set_annot_stamp_image(this.pointer,e.pointer)}setAppearanceFromDisplayList(e,t,_,r){f(_),d(r,DisplayList),n._wasm_pdf_set_annot_appearance_from_display_list(this.pointer,y(e),x(t),I(_),r.pointer)}setAppearance(e,t,_,r,i,s){f(_),h(r),n._wasm_pdf_set_annot_appearance(this.pointer,y(e),x(t),I(_),T(r),this._doc._PDFOBJ(i),D(s))}applyRedaction(e=1,t=2,_=1,r=0){n._wasm_pdf_apply_redaction(this.pointer,e,t,_,r)}}PDFAnnotation._drop=n._wasm_pdf_drop_annot,PDFAnnotation.ANNOT_TYPES=["Text","Link","FreeText","Line","Square","Circle","Polygon","PolyLine","Highlight","Underline","Squiggly","StrikeOut","Redact","Stamp","Caret","Ink","Popup","FileAttachment","Sound","Movie","RichMedia","Widget","Screen","PrinterMark","TrapNet","Watermark","3D","Projection"],PDFAnnotation.LINE_ENDING=["None","Square","Circle","Diamond","OpenArrow","ClosedArrow","Butt","ROpenArrow","RClosedArrow","Slash"],PDFAnnotation.BORDER_STYLE=["Solid","Dashed","Beveled","Inset","Underline"],PDFAnnotation.BORDER_EFFECT=["None","Cloudy"],PDFAnnotation.INTENT=[null,"FreeTextCallout","FreeTextTypeWriter","LineArrow","LineDimension","PloyLine","PolygonCloud","PolygonDimension","StampImage","StampSnapshot"],PDFAnnotation.IS_INVISIBLE=1,PDFAnnotation.IS_HIDDEN=2,PDFAnnotation.IS_PRINT=4,PDFAnnotation.IS_NO_ZOOM=8,PDFAnnotation.IS_NO_ROTATE=16,PDFAnnotation.IS_NO_VIEW=32,PDFAnnotation.IS_READ_ONLY=64,PDFAnnotation.IS_LOCKED=128,PDFAnnotation.IS_TOGGLE_NO_VIEW=256,PDFAnnotation.IS_LOCKED_CONTENTS=512;export class PDFWidget extends PDFAnnotation{getFieldType(){return PDFWidget.WIDGET_TYPES[n._wasm_pdf_annot_field_type(this.pointer)]||"button"}isButton(){let e=this.getFieldType();return"button"===e||"checkbox"===e||"radiobutton"===e}isPushButton(){return"button"===this.getFieldType()}isCheckbox(){return"checkbox"===this.getFieldType()}isRadioButton(){return"radiobutton"===this.getFieldType()}isText(){return"text"===this.getFieldType()}isChoice(){let e=this.getFieldType();return"combobox"===e||"listbox"===e}isListBox(){return"listbox"===this.getFieldType()}isComboBox(){return"combobox"===this.getFieldType()}getFieldFlags(){return n._wasm_pdf_annot_field_flags(this.pointer)}isMultiline(){return!!(this.getFieldFlags()&PDFWidget.TX_FIELD_IS_MULTILINE)}isPassword(){return!!(this.getFieldFlags()&PDFWidget.TX_FIELD_IS_PASSWORD)}isComb(){return!!(this.getFieldFlags()&PDFWidget.TX_FIELD_IS_COMB)}isReadOnly(){return!!(this.getFieldFlags()&PDFWidget.FIELD_IS_READ_ONLY)}getLabel(){return v(n._wasm_pdf_annot_field_label(this.pointer))}getName(){return B(n._wasm_pdf_load_field_name(this.pointer))}getValue(){return v(n._wasm_pdf_annot_field_value(this.pointer))}setTextValue(e){return n._wasm_pdf_set_annot_text_field_value(this.pointer,F(e))}getMaxLen(){return n._wasm_pdf_annot_text_widget_max_len(this.pointer)}setChoiceValue(e){return n._wasm_pdf_set_annot_choice_field_value(this.pointer,F(e))}getOptions(e=!1){let t=[],_=n._wasm_pdf_annot_choice_field_option_count(this.pointer);for(let r=0;r<_;++r)t.push(v(n._wasm_pdf_annot_choice_field_option(this.pointer,e,r)));return t}toggle(){return n._wasm_pdf_toggle_widget(this.pointer)}}PDFWidget.WIDGET_TYPES=["widget","button","checkbox","combobox","listbox","radiobutton","signature","text"],PDFWidget.FIELD_IS_READ_ONLY=1,PDFWidget.FIELD_IS_REQUIRED=2,PDFWidget.FIELD_IS_NO_EXPORT=4,PDFWidget.TX_FIELD_IS_MULTILINE=4096,PDFWidget.TX_FIELD_IS_PASSWORD=8192,PDFWidget.TX_FIELD_IS_COMB=1<<24,PDFWidget.BTN_FIELD_IS_NO_TOGGLE_TO_OFF=16384,PDFWidget.BTN_FIELD_IS_RADIO=32768,PDFWidget.BTN_FIELD_IS_PUSHBUTTON=65536,PDFWidget.CH_FIELD_IS_COMBO=1<<17,PDFWidget.CH_FIELD_IS_EDIT=1<<18,PDFWidget.CH_FIELD_IS_SORT=1<<19,PDFWidget.CH_FIELD_IS_MULTI_SELECT=1<<21;var J,V=0,K=new Map;globalThis.$libmupdf_stm_close=function(e){let t=K.get(e);if(t)return t.close(),void K.delete(e);throw new Error("invalid file handle")},globalThis.$libmupdf_stm_seek=function(e,t,n,_){let r=K.get(e);if(r){if(0===_)return n;if(1===_)return t+n;if(2===_){let e=r.fileSize();return e<0?-1:e+n}throw new Error("invalid whence argument")}throw new Error("invalid file handle")},globalThis.$libmupdf_stm_read=function(e,t,_,r){let i=K.get(e);if(i)return i.read(n.HEAPU8,_,r,t);throw new Error("invalid file handle")};export class Stream extends W{constructor(e){let t=V++;K.set(t,e),super(n._wasm_new_stream(t))}}Stream._drop=n._wasm_drop_stream,globalThis.$libmupdf_load_font_file=function(e,t,n,_){if(J){var r=J(v(e),v(t),n,_);if(r)return d(r,Font),r.pointer}return 0};var Y=0,z=new Map,X=0,q=new Map,$=0,Q=new Map;globalThis.$libmupdf_path_walk={moveto(e,t,n){q.get(e)?.moveTo?.(t,n)},lineto(e,t,n){q.get(e)?.lineTo?.(t,n)},curveto(e,t,n,_,r,i,s){q.get(e)?.curveTo?.(t,n,_,r,i,s)},closepath(e){q.get(e)?.closePath?.()}};var Z=null;globalThis.$libmupdf_text_walk={begin_span(e,t,n,_,r,i,s){t!==Z?.pointer&&(Z=new Font(t)),Q.get(e)?.beginSpan?.(Z,H(n),_,r,i,v(s))},end_span(e){Q.get(e)?.endSpan?.()},show_glyph(e,t,n,_,r,i,s){t!==Z?.pointer&&(Z=new Font(t)),Q.get(e)?.showGlyph?.(Z,H(n),_,r,i,s)}},globalThis.$libmupdf_device={drop_device(e){z.get(e)?.drop?.(),z.delete(e)},close_device(e){z.get(e)?.close?.()},fill_path(e,t,_,r,i,s,o,a){z.get(e)?.fillPath?.(new Path(n._wasm_keep_path(t)),!!_,H(r),new ColorSpace(n._wasm_keep_colorspace(i)),C(s,o),a)},clip_path(e,t,_,r){z.get(e)?.clipPath?.(new Path(n._wasm_keep_path(t)),!!_,H(r))},stroke_path(e,t,_,r,i,s,o,a){z.get(e)?.strokePath?.(new Path(n._wasm_keep_path(t)),new StrokeState(n._wasm_keep_stroke_state(_)),H(r),new ColorSpace(n._wasm_keep_colorspace(i)),C(s,o),a)},clip_stroke_path(e,t,_,r){z.get(e)?.clipStrokePath?.(new Path(n._wasm_keep_path(t)),new StrokeState(n._wasm_keep_stroke_state(_)),H(r))},fill_text(e,t,_,r,i,s,o){z.get(e)?.fillText?.(new Text(n._wasm_keep_text(t)),H(_),new ColorSpace(n._wasm_keep_colorspace(r)),C(i,s),o)},stroke_text(e,t,_,r,i,s,o,a){z.get(e)?.strokeText?.(new Text(n._wasm_keep_text(t)),new StrokeState(n._wasm_keep_stroke_state(_)),H(r),new ColorSpace(n._wasm_keep_colorspace(i)),C(s,o),a)},clip_text(e,t,_){z.get(e)?.clipText?.(new Text(n._wasm_keep_text(t)),H(_))},clip_stroke_text(e,t,_,r){z.get(e)?.clipStrokeText?.(new Text(n._wasm_keep_text(t)),new StrokeState(n._wasm_keep_stroke_state(_)),H(r))},ignore_text(e,t,_){z.get(e)?.ignoreText?.(new Text(n._wasm_keep_text(t)),H(_))},fill_shade(e,t,n,_){z.get(e)?.fillShade?.(new Shade(t),H(n),_)},fill_image(e,t,n,_){z.get(e)?.fillImage?.(new Image(t),H(n),_)},fill_image_mask(e,t,_,r,i,s,o){z.get(e)?.fillImageMask?.(new Image(t),H(_),new ColorSpace(n._wasm_keep_colorspace(r)),C(i,s),o)},clip_image_mask(e,t,n){z.get(e)?.clipImageMask?.(new Image(t),H(n))},pop_clip(e){z.get(e)?.popClip?.()},begin_mask(e,t,_,r,i,s){z.get(e)?.beginMask?.(j(t),!!_,new ColorSpace(n._wasm_keep_colorspace(r)),C(i,s))},begin_group(e,t,_,r,i,s,o){z.get(e)?.beginGroup?.(j(t),new ColorSpace(n._wasm_keep_colorspace(_)),!!r,!!i,Device.BLEND_MODES[s],o)},begin_tile:(e,t,n,_,r,i,s)=>z.get(e)?.beginTile?.(j(t),j(n),_,r,H(i),s)||0,begin_layer(e,t){z.get(e)?.beginLayer?.(v(t))},end_mask(e){z.get(e)?.endMask?.()},end_group(e){z.get(e)?.endGroup?.()},end_tile(e){z.get(e)?.endTile?.()},end_layer(e){z.get(e)?.endLayer?.()}};export default{Matrix:Matrix,Rect:Rect,enableICC:enableICC,disableICC:disableICC,setUserCSS:setUserCSS,installLoadFontFunction:installLoadFontFunction,Buffer:Buffer,ColorSpace:ColorSpace,Font:Font,Image:Image,StrokeState:StrokeState,Path:Path,Text:Text,DisplayList:DisplayList,Pixmap:Pixmap,Shade:Shade,StructuredText:StructuredText,Device:Device,DrawDevice:DrawDevice,DisplayListDevice:DisplayListDevice,DocumentWriter:DocumentWriter,Document:Document,OutlineIterator:OutlineIterator,Link:Link,Page:Page,PDFDocument:PDFDocument,PDFPage:PDFPage,PDFObject:PDFObject,PDFGraftMap:PDFGraftMap,PDFAnnotation:PDFAnnotation,PDFWidget:PDFWidget,Stream:Stream,memento:memento};